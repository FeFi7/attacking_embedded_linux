From 98e175cca24002a8e97a3a9d8ee1679918a0491b Mon Sep 17 00:00:00 2001
From: Felix Filser <felix.filser.ext@nokia.com>
Date: Fri, 3 Jun 2022 10:44:05 +0200
Subject: [PATCH 2/5] Prepare OpenSSL CVE 2021-3449

---
 .../openssl/openssl_3.0.1.bb                  | 21 ++++++++++++-------
 1 file changed, 13 insertions(+), 8 deletions(-)

diff --git a/meta/recipes-connectivity/openssl/openssl_3.0.1.bb b/meta/recipes-connectivity/openssl/openssl_3.0.1.bb
index 1128f6a737..5c0b91d9e9 100644
--- a/meta/recipes-connectivity/openssl/openssl_3.0.1.bb
+++ b/meta/recipes-connectivity/openssl/openssl_3.0.1.bb
@@ -7,21 +7,26 @@ SECTION = "libs/network"
 LICENSE = "Apache-2.0"
 LIC_FILES_CHKSUM = "file://LICENSE.txt;md5=c75985e733726beaba57bc5253e96d04"
 
-SRC_URI = "http://www.openssl.org/source/openssl-${PV}.tar.gz \
-           file://run-ptest \
-           file://0001-buildinfo-strip-sysroot-and-debug-prefix-map-from-co.patch \
-           file://afalg.patch \
-           file://0001-Configure-do-not-tweak-mips-cflags.patch \
-           file://reproducibility.patch \
+SRC_URI = "https://github.com/openssl/openssl/archive/refs/tags/openssl-3.0.0-alpha13.tar.gz \
+	   file://run-ptest \
            "
+  
+S = "${WORKDIR}/openssl-openssl-3.0.0-alpha13"  
+
+        
+#file://0001-buildinfo-strip-sysroot-and-debug-prefix-map-from-co.patch
+#file://afalg.patch \
+#file://0001-Configure-do-not-tweak-mips-cflags.patch
+#file://reproducibility.patch 
 
 SRC_URI:append:class-nativesdk = " \
            file://environment.d-openssl.sh \
            "
 
-SRC_URI[sha256sum] = "c311ad853353bce796edad01a862c50a8a587f62e7e2100ef465ab53ec9b06d1"
+#SRC_URI[sha256sum] = "c311ad853353bce796edad01a862c50a8a587f62e7e2100ef465ab53ec9b06d1"
+SRC_URI[sha256sum] = "55e2b414436314b59395402323dbc2d7f8045f27cd5335d7997a5a7343defd8d"
 
-inherit lib_package multilib_header multilib_script ptest perlnative
+inherit lib_package multilib_header multilib_script perlnative
 MULTILIB_SCRIPTS = "${PN}-bin:${bindir}/c_rehash"
 
 PACKAGECONFIG ?= ""
-- 
2.30.2

